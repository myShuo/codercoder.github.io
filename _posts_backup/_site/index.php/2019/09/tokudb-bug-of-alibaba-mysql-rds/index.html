<p><a href="http://codercoder.cn/wp-content/uploads/2019/09/2019-09-1857.jpg"><img src="http://codercoder.cn/wp-content/uploads/2019/09/2019-09-1857-150x150.jpg" alt="" /></a></p>

<h1 id="背景"><strong>背景：</strong></h1>

<p>近日在进行表结构变更时，发现一个存储引擎为TokuDB的表变更字段花费了10个小时。但是对于TokuDB，字段变更应该是秒级完成的。至此向阿里云提交了bug。</p>

<h1 id="环境"><strong>环境：</strong></h1>

<p>阿里云RDS for MySQL 5.6版本<br />
表的存储引擎：TokuDB</p>

<h1 id="回复"><strong>回复：</strong></h1>

<p>阿里云目前不再进行TokuDB的更新和维护，所以建议不再使用该存储引擎。</p>

<h1 id="相似bug"><strong>相似bug：</strong></h1>

<p><a href="https://dba.stackexchange.com/questions/144919/tokudb-hot-column-expansion">tokudb-hot-column-expansion</a><br />
<a href="https://jira.mariadb.org/browse/MDEV-19107">[bugfix] Issue: #62 alter TokuDB table comment rebuild whole engine data</a></p>

<h1 id="规避措施">规避措施：</h1>

<p>（1）不使用TokuDB存储引擎<br />
（2）监控结构变更的状态，控制执行时间，若某个时间内没有执行成功，则kill变更线程<br />
（3）使用pt-online-schema-change进行结构变更</p>
